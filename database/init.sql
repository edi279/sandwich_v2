-- 샌냠 데이터베이스 초기화 스크립트
-- 데이터베이스 생성 (이미 존재하는 경우 무시)
CREATE DATABASE IF NOT EXISTS sandwich_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE sandwich_db;

-- 회원 테이블 (USER_TB)
CREATE TABLE IF NOT EXISTS USER_TB (
    USER_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '회원 ID',
    EMAIL VARCHAR(255) NOT NULL COMMENT '로그인 이메일',
    PASSWORD_HASH VARCHAR(255) COMMENT '비밀번호 해시 (이메일 회원용)',
    NICKNAME VARCHAR(50) NOT NULL COMMENT '닉네임',
    BIRTH VARCHAR(8) NOT NULL COMMENT '생년월일 (yyyyMMdd)',
    EVENT_OPT_IN_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '이벤트, 광고 수신 동의 여부 (Y/N)',
    GOOGLE_ID VARCHAR(100) COMMENT '연동된 구글 계정 ID',
    GOOGLE_LINKED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '구글 계정 연동 여부',
    PROFILE_IMAGE_URL VARCHAR(500) COMMENT '프로필 이미지 URL',
    BLOCKED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '차단 여부 (Y: 차단됨, N: 정상)',
    DELETED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '탈퇴 여부 (Y: 탈퇴됨, N: 정상)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '가입일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    UNIQUE KEY uk_user_email (EMAIL),
    UNIQUE KEY uk_user_google_id (GOOGLE_ID),
    INDEX idx_blocked_yn (BLOCKED_YN),
    INDEX idx_user_deleted_yn (DELETED_YN)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='회원 테이블';

-- 게시판 및 카테고리 분류 테이블 (MENU_TB)
CREATE TABLE IF NOT EXISTS MENU_TB (
    MENU_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '게시판 및 카테고리 ID',
    MENU_TYPE VARCHAR(10) NOT NULL COMMENT '메뉴 타입 (B: 게시판, C: 카테고리)',
    MENU_NAME VARCHAR(20) NOT NULL COMMENT '명칭',
    MENU_TOP INT COMMENT '상위 메뉴(카테고리일 시, 해당하는 게시판 ID)',
    USED_YN CHAR(1) NOT NULL DEFAULT 'Y' COMMENT '사용 여부 (Y: 사용, N: 미사용)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    INDEX idx_menu_type (MENU_TYPE),
    INDEX idx_menu_name (MENU_NAME),
    INDEX idx_created_at (CREATED_AT)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='게시판 및 카테고리 분류 테이블';

-- "이렇게 만들어요" 게시판 테이블 (RECIPE_TB)
CREATE TABLE IF NOT EXISTS RECIPE_TB (
    RECIPE_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '레시피 게시글 ID',
    TITLE VARCHAR(200) NOT NULL COMMENT '제목',
    IMAGE_URL VARCHAR(500) COMMENT '이미지 URL',
    AUTHOR_ID INT COMMENT '작성자 ID',
    AUTHOR_NAME VARCHAR(50) COMMENT '작성자 이름',
    CATEGORY INT NOT NULL DEFAULT 3 COMMENT '카테고리 (MENU_TB의 MENU_ID 참조)',
    VIEWS INT DEFAULT 0 COMMENT '조회수',
    DELETED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '삭제 여부 (Y: 삭제됨, N: 정상)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '작성일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    INDEX idx_category (CATEGORY),
    INDEX idx_created_at (CREATED_AT),
    INDEX idx_views (VIEWS),
    INDEX idx_recipe_deleted_yn (DELETED_YN),
    CONSTRAINT fk_recipe_category FOREIGN KEY (CATEGORY) REFERENCES MENU_TB(MENU_ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='레시피 게시판 테이블';

-- "정보 공유해요" 게시판 테이블 (TIP_TB)
CREATE TABLE IF NOT EXISTS TIP_TB (
    TIP_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '정보 공유 게시글 ID',
    TITLE VARCHAR(200) NOT NULL COMMENT '제목',
    AUTHOR_ID INT COMMENT '작성자 ID',
    AUTHOR_NAME VARCHAR(50) COMMENT '작성자 이름',
    CATEGORY INT NOT NULL DEFAULT 5 COMMENT '카테고리 (MENU_TB의 MENU_ID 참조)',
    VIEWS INT DEFAULT 0 COMMENT '조회수',
    DELETED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '삭제 여부 (Y: 삭제됨, N: 정상)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '작성일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    INDEX idx_category (CATEGORY),
    INDEX idx_created_at (CREATED_AT),
    INDEX idx_views (VIEWS),
    INDEX idx_tip_deleted_yn (DELETED_YN),
    CONSTRAINT fk_tip_category FOREIGN KEY (CATEGORY) REFERENCES MENU_TB(MENU_ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='정보 공유 게시판 테이블';

-- 레시피 게시글 본문 테이블 (RECIPE_CONTENT_TB)
CREATE TABLE IF NOT EXISTS RECIPE_CONTENT_TB (
    RECIPE_CONTENT_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '레시피 본문 ID',
    RECIPE_ID INT NOT NULL COMMENT '레시피 게시글 ID',
    CONTENT LONGTEXT NOT NULL COMMENT '본문 내용 (HTML 형식, 이미지, 텍스트, 하이퍼링크 등 포함)',
    TAGS TEXT COMMENT '태그 (쉼표로 구분)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '작성일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    FOREIGN KEY (RECIPE_ID) REFERENCES RECIPE_TB(RECIPE_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    INDEX idx_recipe_id (RECIPE_ID),
    INDEX idx_created_at (CREATED_AT),
    UNIQUE KEY uk_recipe_id (RECIPE_ID) COMMENT '한 게시글당 하나의 본문만 허용'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='레시피 게시글 본문 테이블';

-- 정보 공유 게시글 본문 테이블 (TIP_CONTENT_TB)
CREATE TABLE IF NOT EXISTS TIP_CONTENT_TB (
    TIP_CONTENT_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '정보 공유 본문 ID',
    TIP_ID INT NOT NULL COMMENT '정보 공유 게시글 ID',
    CONTENT LONGTEXT NOT NULL COMMENT '본문 내용 (HTML 형식, 이미지, 텍스트, 하이퍼링크 등 포함)',
    TAGS TEXT COMMENT '태그 (쉼표로 구분)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '작성일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    FOREIGN KEY (TIP_ID) REFERENCES TIP_TB(TIP_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    INDEX idx_tip_id (TIP_ID),
    INDEX idx_created_at (CREATED_AT),
    UNIQUE KEY uk_tip_id (TIP_ID) COMMENT '한 게시글당 하나의 본문만 허용'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='정보 공유 게시글 본문 테이블';

-- 댓글 테이블 (COMMENT_TB)
CREATE TABLE IF NOT EXISTS COMMENT_TB (
    COMMENT_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '댓글 ID',
    POST_TYPE INT NOT NULL COMMENT '게시글 타입 (1: 레시피, 2: 정보공유)',
    POST_ID INT NOT NULL COMMENT '게시글 ID (RECIPE_ID 또는 TIP_ID)',
    CONTENT TEXT NOT NULL COMMENT '댓글 내용',
    AUTHOR_ID INT COMMENT '작성자 ID (추후 인증 기능 추가 시 사용)',
    AUTHOR_NAME VARCHAR(50) NOT NULL COMMENT '작성자 이름',
    DELETED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '삭제 여부 (Y: 삭제됨, N: 정상)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '작성시각',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정시각',
    INDEX idx_post_type_id (POST_TYPE, POST_ID),
    INDEX idx_created_at (CREATED_AT),
    INDEX idx_deleted_yn (DELETED_YN),
    CONSTRAINT fk_comment_post_type FOREIGN KEY (POST_TYPE) REFERENCES MENU_TB(MENU_ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='댓글 테이블';

-- 레시피 게시글 조인 View (RECIPE_TB + RECIPE_CONTENT_TB + MENU_TB)
CREATE OR REPLACE VIEW V_RECIPE_WITH_CONTENT AS
SELECT 
    r.RECIPE_ID,
    r.TITLE,
    r.IMAGE_URL,
    r.AUTHOR_ID,
    r.AUTHOR_NAME,
    r.CATEGORY,
    m.MENU_NAME AS CATEGORY_NAME,
    r.VIEWS,
    r.CREATED_AT,
    r.UPDATED_AT,
    r.DELETED_YN,
    rc.RECIPE_CONTENT_ID,
    rc.CONTENT,
    rc.TAGS
FROM RECIPE_TB r
LEFT JOIN RECIPE_CONTENT_TB rc ON r.RECIPE_ID = rc.RECIPE_ID
LEFT JOIN MENU_TB m ON r.CATEGORY = m.MENU_ID;

-- 정보 공유 게시글 조인 View (TIP_TB + TIP_CONTENT_TB + MENU_TB)
CREATE OR REPLACE VIEW V_TIP_WITH_CONTENT AS
SELECT 
    t.TIP_ID,
    t.TITLE,
    t.AUTHOR_ID,
    t.AUTHOR_NAME,
    t.CATEGORY,
    m.MENU_NAME AS CATEGORY_NAME,
    t.VIEWS,
    t.CREATED_AT,
    t.UPDATED_AT,
    t.DELETED_YN,
    tc.TIP_CONTENT_ID,
    tc.CONTENT,
    tc.TAGS
FROM TIP_TB t
LEFT JOIN TIP_CONTENT_TB tc ON t.TIP_ID = tc.TIP_ID
LEFT JOIN MENU_TB m ON t.CATEGORY = m.MENU_ID;

-- 북마크 테이블 (BOOKMARK_TB)
CREATE TABLE IF NOT EXISTS BOOKMARK_TB (
    BOOKMARK_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '북마크 ID',
    USER_ID INT NOT NULL COMMENT '사용자 ID',
    POST_TYPE INT NOT NULL COMMENT '게시글 타입 (1: 레시피, 2: 정보공유)',
    POST_ID INT NOT NULL COMMENT '게시글 ID (RECIPE_ID 또는 TIP_ID)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '북마크 등록일',
    INDEX idx_user_id (USER_ID),
    INDEX idx_post_type_id (POST_TYPE, POST_ID),
    INDEX idx_created_at (CREATED_AT),
    UNIQUE KEY uk_user_post (USER_ID, POST_TYPE, POST_ID) COMMENT '사용자별 게시글 중복 북마크 방지',
    CONSTRAINT fk_bookmark_user FOREIGN KEY (USER_ID) REFERENCES USER_TB(USER_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT fk_bookmark_post_type FOREIGN KEY (POST_TYPE) REFERENCES MENU_TB(MENU_ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='북마크 테이블';

-- 뱃지 종류 테이블 (BADGE_TYPE_TB)
CREATE TABLE IF NOT EXISTS BADGE_TYPE_TB (
    BADGE_TYPE_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '뱃지 종류 ID',
    BADGE_NAME VARCHAR(50) NOT NULL COMMENT '뱃지 이름',
    BADGE_ICON TEXT COMMENT '뱃지 아이콘 (SVG)',
    BADGE_DESCRIPTION TEXT COMMENT '뱃지 설명',
    CONDITION_TYPE VARCHAR(20) COMMENT '획득 조건 타입 (BA001, BR001, CW001, etc.)',
    CONDITION_VALUE INT COMMENT '획득 조건 값',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '생성일',
    INDEX idx_condition_type (CONDITION_TYPE),
    UNIQUE KEY uk_condition_type (CONDITION_TYPE) COMMENT '뱃지 코드 중복 방지'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='뱃지 종류 테이블';

-- 사용자 뱃지 획득 테이블 (USER_BADGE_TB)
CREATE TABLE IF NOT EXISTS USER_BADGE_TB (
    USER_BADGE_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '사용자 뱃지 ID',
    USER_ID INT NOT NULL COMMENT '사용자 ID',
    BADGE_TYPE_ID INT NOT NULL COMMENT '뱃지 종류 ID',
    EARNED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '획득일',
    INDEX idx_user_id (USER_ID),
    INDEX idx_badge_type_id (BADGE_TYPE_ID),
    INDEX idx_earned_at (EARNED_AT),
    UNIQUE KEY uk_user_badge (USER_ID, BADGE_TYPE_ID) COMMENT '사용자별 뱃지 중복 획득 방지',
    CONSTRAINT fk_user_badge_user FOREIGN KEY (USER_ID) REFERENCES USER_TB(USER_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT fk_user_badge_type FOREIGN KEY (BADGE_TYPE_ID) REFERENCES BADGE_TYPE_TB(BADGE_TYPE_ID) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='사용자 뱃지 획득 테이블';

-- 추천(좋아요) 테이블 (LIKE_TB)
CREATE TABLE IF NOT EXISTS LIKE_TB (
    LIKE_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '추천 ID',
    USER_ID INT NOT NULL COMMENT '사용자 ID',
    POST_TYPE INT NOT NULL COMMENT '게시글 타입 (1: 레시피, 2: 정보공유)',
    POST_ID INT NOT NULL COMMENT '게시글 ID (RECIPE_ID 또는 TIP_ID)',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '추천 등록일',
    INDEX idx_user_id (USER_ID),
    INDEX idx_post_type_id (POST_TYPE, POST_ID),
    INDEX idx_created_at (CREATED_AT),
    UNIQUE KEY uk_user_post (USER_ID, POST_TYPE, POST_ID) COMMENT '사용자별 게시글 중복 추천 방지',
    CONSTRAINT fk_like_user FOREIGN KEY (USER_ID) REFERENCES USER_TB(USER_ID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT fk_like_post_type FOREIGN KEY (POST_TYPE) REFERENCES MENU_TB(MENU_ID) ON UPDATE CASCADE ON DELETE RESTRICT
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='추천(좋아요) 테이블';

-- 뱃지 종류 데이터 초기화
INSERT IGNORE INTO BADGE_TYPE_TB (BADGE_NAME, BADGE_ICON, BADGE_DESCRIPTION, CONDITION_TYPE, CONDITION_VALUE) VALUES
('환영해요', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#0D5423" class="bi bi-emoji-smile" viewBox="0 0 16 16"><path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/><path d="M4.285 9.567a.5.5 0 0 1 .683.183A3.5 3.5 0 0 0 8 11.5a3.5 3.5 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.5 4.5 0 0 1 8 12.5a4.5 4.5 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5"/></svg>', '회원 가입 후 최초 게시글 작성', 'BA001', 1),
('맛의 시작', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#9D9EA8" class="bi bi-fork-knife" viewBox="0 0 16 16"><path d="M13 .5c0-.276-.226-.506-.498-.465-1.703.257-2.94 2.012-3 8.462a.5.5 0 0 0 .498.5c.56.01 1 .13 1 1.003v5.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5zM4.25 0a.25.25 0 0 1 .25.25v5.122a.128.128 0 0 0 .256.006l.233-5.14A.25.25 0 0 1 5.24 0h.522a.25.25 0 0 1 .25.238l.233 5.14a.128.128 0 0 0 .256-.006V.25A.25.25 0 0 1 6.75 0h.29a.5.5 0 0 1 .498.458l.423 5.07a1.69 1.69 0 0 1-1.059 1.711l-.053.022a.92.92 0 0 0-.58.884L6.47 15a.971.971 0 1 1-1.942 0l.202-6.855a.92.92 0 0 0-.58-.884l-.053-.022a1.69 1.69 0 0 1-1.059-1.712L3.462.458A.5.5 0 0 1 3.96 0z"/></svg>', '"이렇게 만들어요" 게시판 게시글 최초 1회 작성', 'BR001', 1),
('교류의 시작', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#0E7C49" class="bi bi-chat-quote" viewBox="0 0 16 16"><path d="M2.678 11.894a1 1 0 0 1 .287.801 11 11 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8 8 0 0 0 8 14c3.996 0 7-2.807 7-6s-3.004-6-7-6-7 2.808-7 6c0 1.468.617 2.83 1.678 3.894m-.493 3.905a22 22 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a10 10 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9 9 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105"/><path d="M7.066 6.76A1.665 1.665 0 0 0 4 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112zm4 0A1.665 1.665 0 0 0 8 7.668a1.667 1.667 0 0 0 2.561 1.406c-.131.389-.375.804-.777 1.22a.417.417 0 0 0 .6.58c1.486-1.54 1.293-3.214.682-4.112z"/></svg>', '댓글 최초 5개 작성', 'CW001', 5),
('소문의 시작', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#0D6EFD" class="bi bi-hand-thumbs-up" viewBox="0 0 16 16"><path d="M8.864.046C7.908-.193 7.02.53 6.956 1.466c-.072 1.051-.23 2.016-.428 2.59-.125.36-.479 1.013-1.04 1.639-.557.623-1.282 1.178-2.131 1.41C2.685 7.288 2 7.87 2 8.72v4.001c0 .845.682 1.464 1.448 1.545 1.07.114 1.564.415 2.068.723l.048.03c.272.165.578.348.97.484.397.136.861.217 1.466.217h3.5c.937 0 1.599-.477 1.934-1.064a1.86 1.86 0 0 0 .254-.912c0-.152-.023-.312-.077-.464.201-.263.38-.578.488-.901.11-.33.172-.762.004-1.149.069-.13.12-.269.159-.403.077-.27.113-.568.113-.857 0-.288-.036-.585-.113-.856a2 2 0 0 0-.138-.362 1.9 1.9 0 0 0 .234-1.734c-.206-.592-.682-1.1-1.2-1.272-.847-.282-1.803-.276-2.516-.211a10 10 0 0 0-.443.05 9.4 9.4 0 0 0-.062-4.509A1.38 1.38 0 0 0 9.125.111zM11.5 14.721H8c-.51 0-.863-.069-1.14-.164-.281-.097-.506-.228-.776-.393l-.04-.024c-.555-.339-1.198-.731-2.49-.868-.333-.036-.554-.29-.554-.55V8.72c0-.254.226-.543.62-.65 1.095-.3 1.977-.996 2.614-1.708.635-.71 1.064-1.475 1.238-1.978.243-.7.407-1.768.482-2.85.025-.362.36-.594.667-.518l.262.066c.16.04.258.143.288.255a8.34 8.34 0 0 1-.145 4.725.5.5 0 0 0 .595.644l.003-.001.014-.003.058-.014a9 9 0 0 1 1.036-.157c.663-.06 1.457-.054 2.11.164.175.058.45.3.57.65.107.308.087.67-.266 1.022l-.353.353.353.354c.043.043.105.141.154.315.048.167.075.37.075.581 0 .212-.027.414-.075.582-.05.174-.111.272-.154.315l-.353.353.353.354c.047.047.109.177.005.488a2.2 2.2 0 0 1-.505.805l-.353.353.353.354c.006.005.041.05.041.17a.9.9 0 0 1-.121.416c-.165.288-.503.56-1.066.56z"/></svg>', '내가 작성한 게시글이 최초로 추천 5회를 받음', 'LG001', 5),
('이슈의 시작', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#FCEF00" class="bi bi-lightning" viewBox="0 0 16 16"><path d="M5.52.359A.5.5 0 0 1 6 0h4a.5.5 0 0 1 .474.658L8.694 6H12.5a.5.5 0 0 1 .395.807l-7 9a.5.5 0 0 1-.873-.454L6.823 9.5H3.5a.5.5 0 0 1-.48-.641zM6.374 1 4.168 8.5H7.5a.5.5 0 0 1 .478.647L6.78 13.04 11.478 7H8a.5.5 0 0 1-.474-.658L9.306 1z"/></svg>', '내가 작성한 게시글에 댓글이 최초로 10개 이상 달림', 'CG001', 10),
('따스한 추천자', '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#DEA49A" class="bi bi-search-heart" viewBox="0 0 16 16"><path d="M6.5 4.482c1.664-1.673 5.825 1.254 0 5.018-5.825-3.764-1.664-6.69 0-5.018"/><path d="M13 6.5a6.47 6.47 0 0 1-1.258 3.844q.06.044.115.098l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1-.1-.115h.002A6.5 6.5 0 1 1 13 6.5M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11"/></svg>', '내가 추천한 게시글이 누적 30개', 'LW001', 30);

-- 관리자 테이블 (ADMIN_TB)
CREATE TABLE IF NOT EXISTS ADMIN_TB (
    ADMIN_ID INT AUTO_INCREMENT PRIMARY KEY COMMENT '관리자 ID',
    EMAIL VARCHAR(255) NOT NULL COMMENT '관리자 이메일',
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '등록일',
    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정일',
    UNIQUE KEY uk_admin_email (EMAIL)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='관리자 테이블';

-- 관리자 계정 초기화
INSERT IGNORE INTO ADMIN_TB (EMAIL) VALUES ('admin@swnn.com');

-- 참고: 기존 데이터베이스에 관리자 기능을 추가하려면 다음 SQL을 실행하세요:
-- ALTER TABLE USER_TB 
-- ADD COLUMN IF NOT EXISTS BLOCKED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '차단 여부 (Y: 차단됨, N: 정상)' AFTER PROFILE_IMAGE_URL,
-- ADD COLUMN IF NOT EXISTS DELETED_YN CHAR(1) NOT NULL DEFAULT 'N' COMMENT '탈퇴 여부 (Y: 탈퇴됨, N: 정상)' AFTER BLOCKED_YN;
-- CREATE INDEX IF NOT EXISTS idx_blocked_yn ON USER_TB(BLOCKED_YN);
-- CREATE INDEX IF NOT EXISTS idx_user_deleted_yn ON USER_TB(DELETED_YN);